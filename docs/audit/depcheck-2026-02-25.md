# depcheck — 2026-02-25

Salida completa de `npx depcheck` (sin instalar global). Solo auditoría; no se elimina nada en este PR.

---

## Salida

```
Unused dependencies
* cors
* esri-leaflet
* express-rate-limit
* leaflet-draw
* leaflet-fullscreen
* recharts

Unused devDependencies
* @types/leaflet
* @types/react-dom
* autoprefixer
* postcss
* tailwindcss
```

**Missing dependencies:** ninguna reportada por depcheck.

---

## Interpretación

- **No se eliminará nada en este PR.** Este reporte sirve para decidir en PR-5B qué dependencias son seguras de quitar y cuáles hay que investigar.

- **Posibles falsos positivos (revisar antes de borrar):**
  - **cors:** puede estar usada en `server.js` o en rutas como middleware (require/import dinámico o nombre de paquete distinto).
  - **esri-leaflet / leaflet-draw / leaflet-fullscreen:** usadas en componentes de mapa (Leaflet/React-Leaflet); a veces se referencian en capas o plugins que depcheck no sigue.
  - **express-rate-limit:** middleware en Express; a veces se registra con otro nombre o en código condicional.
  - **recharts:** gráficos en React; puede estar en componentes que depcheck no sigue (lazy, rutas dinámicas).
  - **@types/leaflet, @types/react-dom:** tipos TypeScript/JSX; usados por el compilador o el IDE, no por imports directos en código.
  - **autoprefixer, postcss, tailwindcss:** usados por la cadena de build (Tailwind/PostCSS); depcheck no suele seguir configs en `postcss.config.js` / `tailwind.config.js`.

Cuando tengas la lista de “unused” y “missing” arriba, indica cuáles son seguras para PR-5B y cuáles hay que investigar antes.

---

## Batch 1 (PR-5B) — Eliminadas

En la rama `chore/cleanup-pr5b-remove-unused-deps` se eliminaron estas dependencias (verificación en código + `verify:all` OK):

| Paquete | Motivo |
|--------|--------|
| **cors** | No se usa: en `server.js` CORS se configura a mano con `res.setHeader('Access-Control-Allow-Origin', '*')`, etc. |
| **recharts** | No hay imports en `src/`. |
| **leaflet-fullscreen** | No hay imports ni uso en `src/`. |

Tras `npm install`: 41 paquetes menos (incl. transitivas). `npm run verify:all` pasó.

---

## Falsos positivos (no eliminados en batch 1)

- **leaflet-draw:** sí se usa; `src/index.css` tiene `@import 'leaflet-draw/dist/leaflet.draw.css'`. No quitar.
- **@types/leaflet, @types/react-dom, autoprefixer, postcss, tailwindcss:** usados por build/IDE; no tocar sin migrar tooling.

---

## Batch 2 (PR-5C) — Eliminadas

En la rama `chore/cleanup-pr5c-remove-unused-deps-batch2` se eliminaron estas dependencias (búsqueda en repo + `verify:all` OK):

| Paquete | Decisión | Motivo | Evidencia |
|--------|----------|--------|-----------|
| **esri-leaflet** | Eliminado | No hay integración real con el plugin Leaflet (L.esri, FeatureLayer, basemapLayer). ArcGIS se usa vía REST en `src/services/arcgisService.js`, `src/constants/apiEndpoints.js`, `src/constants/mapConfig.js` (fetch/URLs). Solo estaba en `vite.config.js` optimizeDeps.include sin import en código. | Búsqueda: sin `import/require('esri-leaflet')` ni `L.esri` en src/, server/, routes/, scripts/. |
| **express-rate-limit** | Eliminado | No se usa como middleware en Express. Sin `require('express-rate-limit')` ni `rateLimit(` en server.js ni en routes/. | Búsqueda: 0 usos en repo. |

Cambios adicionales: en `vite.config.js` se quitó `'esri-leaflet'` de `optimizeDeps.include` (se dejó solo `'leaflet'`). No había imports muertos que eliminar.

Tras `npm install`: 5 paquetes menos. `npm run verify:all` pasó.

---

## Falsos positivos / No remover (tras batch 2)

- **leaflet-draw:** en uso (CSS en `src/index.css`).
- **@types/leaflet, @types/react-dom, autoprefixer, postcss, tailwindcss:** deps de build/IDE; fuera de scope de esta limpieza.

---

## Post-batches (estado actual)

Salida de `npx depcheck` en el estado actual del repo (tras batches 1 y 2 mergeados en main):

**Unused dependencies:** `leaflet-draw` (falso positivo; ver tabla).

**Unused devDependencies:** `@types/leaflet`, `@types/react-dom`, `autoprefixer`, `postcss`, `tailwindcss` (todos falsos positivos).

**Missing dependencies:** ninguna

### Acción recomendada

| Paquete | Acción | Motivo |
|--------|--------|--------|
| **leaflet-draw** | Mantener (falso positivo) | Uso real: `src/index.css` importa `leaflet-draw/dist/leaflet.draw.css`. No quitar. |
| **@types/leaflet** | Mantener (falso positivo) | Tipos para Leaflet; IDE/JSX. |
| **@types/react-dom** | Mantener (falso positivo) | Tipos React DOM; IDE/JSX. |
| **autoprefixer** | Mantener (falso positivo) | Cadena build (PostCSS/Tailwind). |
| **postcss** | Mantener (falso positivo) | Cadena build. |
| **tailwindcss** | Mantener (falso positivo) | Cadena build. |

Para reducir ruido en ejecuciones futuras se usa `.depcheckrc.json` en la raíz con `ignores` para estos falsos positivos conocidos. Con `npx depcheck --config .depcheckrc.json` la lista unused queda vacía.
